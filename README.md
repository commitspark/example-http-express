# Contentlab Example: Expose Contentlab functionality over HTTP using Express

This repository contains example code for [Contentlab](https://github.com/contentlab-sh/contentlab), the
Git- and GraphQL-based content engine.

---

In cases where you want to expose the GraphQL endpoint and schema generated by Contentlab over HTTP,
the Contentlab library can be wrapped in a web server such as [Express](https://expressjs.com). This
repository holds an example implementation of such a server for a GitHub-based content repository.

In case you simply want to work with content in your own JavaScript- or TypeScript-based application,
you may be better off by running queries and mutations directly against the
[Contentlab library](https://github.com/contentlab-sh/contentlab), without first going through HTTP.
In this case, this example here is not relevant for you.

**Note**: Typically, a repository holding application code will not hold content. Instead, you would use
a second repository where the content model (schema) and content entries are kept, such as
[https://github.com/contentlab-sh/example-content-multilanguage-website](https://github.com/contentlab-sh/example-content-multilanguage-website).
This keeps workflows of developers and content editors independent.

## Starting the Contentlab Express server

1. Run `npm install`
1. Obtain a GitHub "personal access token (classic)" according to the
   [GitHub documentation](https://docs.github.com/en/graphql/guides/forming-calls-with-graphql#authenticating-with-graphql)
   from [here](https://github.com/settings/tokens). Make sure to select the top-level scope `repo`.
1. Get the repository owner and repository name for your **content** repository.

   For example, a repository at `https://github.com/my-org/my-content-repository` has owner `my-org` and
   repository name `my-content-repository`.
1. Copy `.env.dist` to `.env` and fill in your repository owner, name, and GitHub access token.
1. Compile your code with `npm run build` (and do so again after every code change).
1. Run your server with `npm run start`.

The GraphQL endpoint is then available under [http://localhost:3000/main/graphql](http://localhost:3000/main/graphql)
and the generated GraphQL schema as plaintext under
[http://localhost:3000/main/schema](http://localhost:3000/main/schema) (where `main` is the name of a valid branch
in your **content** repository).
